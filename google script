function doPost(e) {
  const ss = SpreadsheetApp.openById("19Y_GyqG6dTAko-1zfkX1nnIYf_L3WsVLxuMNe0EcDAg"); // ID sheet kamu
  const sheet = ss.getSheetByName("Data") || ss.insertSheet("Data");

  // Tambahkan header jika belum ada
  if (sheet.getLastRow() === 0) {
    sheet.appendRow(["Timestamp", "Nama", "Divisi", "Ruang", "Jam Mulai", "Jam Selesai", "Acara"]);
  }

  const nama = e.parameter.nama || "";
  const divisi = e.parameter.divisi || "";
  const ruang = e.parameter.ruang || "";
  const jamMulai = e.parameter.jamMulai || "";
  const jamSelesai = e.parameter.jamSelesai || "";
  const acara = e.parameter.acara || "";

  sheet.appendRow([new Date(), nama, divisi, ruang, jamMulai, jamSelesai, acara]);

  // kirim respon agar browser tahu ini aman untuk CORS
  return ContentService
    .createTextOutput(JSON.stringify({ result: "success" }))
    .setMimeType(ContentService.MimeType.JSON)
    .setHeader("Access-Control-Allow-Origin", "*")
    .setHeader("Access-Control-Allow-Methods", "POST, GET, OPTIONS")
    .setHeader("Access-Control-Allow-Headers", "Content-Type");
}

function doGet(e) {
  return ContentService
    .createTextOutput("OK")
    .setMimeType(ContentService.MimeType.TEXT)
    .setHeader("Access-Control-Allow-Origin", "*");
}
